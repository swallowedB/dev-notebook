# ì¸ì¦ / ì¸ê°€ ì²˜ë¦¬ ì›ë¦¬ ë° ê°œë…

## âœ… ë¡œê·¸ì¸ ì›ë¦¬
- ì¼ë°˜ ë¡œê·¸ì¸ : ì´ë©”ì¼/ë¹„ë²ˆ ì…ë ¥ -> ìœ íš¨ì„± ê²€ì‚¬ -> ë°±ì—”ë“œ ì „ì†¡ -> í† í° ë°›ê¸°
- ì†Œì…œ ë¡œê·¸ì¸ : ë²„íŠ¼ í´ë¦­ -> ì†Œì…œì—ì„œ ì¸ì¦ -> í† í° ë°›ê¸° -> ì„œë²„ì— ì „ë‹¬ -> ê²€ì¦,í™•ì¸ -> JWT ë°œê¸‰ -> JWTë¥¼ ë°›ì•„ì„œ ë³´ê´€(í”„ë¡ íŠ¸)

## âœ… JWT : ì¸ì¦ëœ ì‚¬ìš©ìì¸ì§€ ì‹ë³„í•˜ê¸° ìœ„í•´ ì„œë²„ê°€ ë°œê¸‰í•˜ëŠ” ë””ì§€í„¸ ì‹ ë¶„ì¦ ê°™ì€ ê²ƒ
- êµ¬ì¡° : `.`ìœ¼ë¡œ êµ¬ë¶„ë˜ë©°, `Header(í† í°ì˜ íƒ€ì…ê³¼ ì„œëª…ë°©ì‹)`, `payload(ì‚¬ìš©ì ì •ë³´ ë“± ì‹¤ì œ ë°ì´í„°)`, `Singature(2ê°œ+ë¹„ë°€í‚¤ë¡œ ë§Œë“  ì„œëª…=ìœ„ì¡°ë°©ì§€)`

- í™œìš© : ì„œë²„ê°€ JWT ë°œê¸‰í•´ì£¼ë©´ ì´ê±¸ `ì¿ í‚¤ë“  ë¡œì»¬ì´ë“  ì–´ë””ì— ì €ì¥`í•´ì„œ `ëª¨ë“  API ìš”ì²­ í—¤ë”ì— JWTë¥¼ ì‹¤ì–´ì„œ ê°™ì´` ë³´ë‚´ì•¼í•¨ -> ì„œë²„ê°€ ì´ë¥¼ ë³´ê³  ì¸ì¦/ì¸ê°€ë¥¼ ì²˜ë¦¬

### âš ï¸ ì£¼ì˜ : ë…¸ì¶œë˜ë©´ ê³§ë°”ë¡œ íƒˆì·¨ ìœ„í—˜ì´ ìˆìœ¼ë¯€ë¡œ ë³´ì•ˆ ì¤‘ìš”!! 
-  `HTTPS` + `ë§Œë£Œì‹œê°„ ì„¤ì •` + `ë¦¬í”„ë ˆì‹œ í† í°`ì„ ê°™ì´ ì‚¬ìš©
  

## âœ… ë§Œë£Œì‹œê°„, ë¦¬í”„ë ˆì‹œ í† í°
  ### ğŸ“ í† í°ì˜ ì¢…ë¥˜
  - Access Token : ì¸ì¦ëœ ì‚¬ìš©ìì„ì„ ì¦ëª…í•˜ëŠ” **ì§§ì€ í† í°** (15ë¶„~1ì‹œê°„)
  - Refresh Token : **Access Tokenì´ ë§Œë£Œ**ë˜ì—ˆì„ ë•Œ, ìƒˆ í† í°ì„ ë°›ì•„ì˜¤ê¸° ìœ„í•œ ê¸´ í† í° (7ì¼~30ì¼)
  - `Access Token(ì§§ê²Œ)- íƒˆì·¨ë¼ë„ í”¼í•´ë¥¼ ìµœì†Œí™”`
  - `Refresh Token(ê¸¸ê²Œ)- ì‚¬ìš©ì í¸ì˜ì„± ìœ ì§€`

## ğŸª 3. JWT vs ì„¸ì…˜ ì¿ í‚¤ ë¹„êµ

| í•­ëª© | JWT | ì„¸ì…˜ ì¿ í‚¤ |
|------|-----|-----------|
| ì €ì¥ ìœ„ì¹˜ | ì£¼ë¡œ **localStorage** / **cookie** | ë¸Œë¼ìš°ì € ì¿ í‚¤ |
| ì„œë²„ ìƒíƒœ | **Stateless** (ì„œë²„ ì €ì¥ X) | **Stateful** (ì„œë²„ì— ì„¸ì…˜ ì €ì¥) |
| í™•ì¥ì„± | ëª¨ë°”ì¼/SPAì— ê°•í•¨ | SSR + ì¿ í‚¤ ê¸°ë°˜ ì•±ì— ê°•í•¨ |
| ë³´ì•ˆ | XSSì— ë¯¼ê° | CSRFì— ë¯¼ê° |
| ì¶”ì²œ | API ê¸°ë°˜, ëª¨ë°”ì¼, React ë“± SPA | ì „í†µì ì¸ ì„œë²„ ê¸°ë°˜ ì›¹ |

## âœ… JWT ë§Œë£Œ ê°ì§€ -> ìë™ ë¡œê·¸ì•„ì›ƒ
1. í† í°ì—ì„œ ë§Œë£Œ ì‹œê°„ `exp` í™•ì¸
   ```
   function getTokenPayload(token){
    const payloadBase64 = token.split('.')[1];
    return JSON.parse(atob(payloadBase64));
   }

   function isTokenExpired(token){
    const { exp } = getTokenPayload(token);
    const now = Math.floor(Date.now() / 1000);
    return exp < now;
   }
   ```

2. ë§¤ ìš”ì²­ ì‹œ ê²€ì‚¬
   ```
   const token = localStorage.getItem('token');
   if(token && isTokenExpired(token)){
    localStorage.removeItem('token');
    alert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
    window.location.href = '/login';
   }
   ```